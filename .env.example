# Example environment file for the drupal-entrypoint.sh
# Copy this to .env and edit values appropriate for your environment.
# Keep secrets (passwords, DSNs) out of VCS or use a secrets manager.

# Startup / DB checks
# If 1, skip the one-time drush DB connection check. Legacy name: SKIP_DB_WAIT
SKIP_DB_CHECK=0
# If 1, require DB connection; entrypoint will exit non-zero if DB check fails
DB_REQUIRED=0

# Drupal auto-install (one-time; entrypoint checks for settings.php)
# Set to 1 to run `drush site:install` automatically.
AUTO_INSTALL=0
# If 1, fail the container if autoinstall fails.
AUTO_INSTALL_REQUIRED=0

# Values used by drush site:install
DRUPAL_SITE_NAME="Drupal Site"
ADMIN_USER=admin
# Use a strong password in production; consider injecting via CI/Secrets
ADMIN_PASS=admin
# Path to Drupal web root used by drush (adjust if your image uses a different path)
DRUSH_ROOT=/opt/drupal/web

# Database connection settings (used to build the DB URL for drush)
# These default names mirror common docker-compose service names.
DRUPAL_DB_HOST=db
DRUPAL_DB_PORT=3306
# DRUPAL_DB_NAME or DB_NAME may be used by the script
DRUPAL_DB_NAME=drupal
DB_NAME=${DRUPAL_DB_NAME}
DRUPAL_DB_USER=drupal
DB_USER=${DRUPAL_DB_USER}
# Plaintext password; prefer injecting at runtime from a secret store
DRUPAL_DB_PASSWORD=secret
DB_PASSWORD=${DRUPAL_DB_PASSWORD}

# MariaDB container settings (use these to configure the mariadb image/service)
# Map to the Drupal DB values above so a single set of credentials is used by both
# Keep secrets (passwords) out of VCS or use a secrets manager in production.
MARIADB_ROOT_PASSWORD=${DRUPAL_DB_PASSWORD}
MARIADB_DATABASE=${DRUPAL_DB_NAME}
MARIADB_USER=${DRUPAL_DB_USER}
MARIADB_PASSWORD=${DRUPAL_DB_PASSWORD}

# Path to write the drupal install log (optional)
DRUPAL_INSTALL_LOG=/var/log/drupal-install.log

# CiviCRM install options
# Set to 1 to run `cv core:install` from the CMS root
CIVICRM_INSTALL=0
# If 1, fail container if CiviCRM install fails
CIVICRM_INSTALL_REQUIRED=0
# Base URL for the CMS (cv requires a reachable URL). Use proper scheme + host.
# The script falls back to http://localhost:${PORT_HTTP:-8080}
CIVICRM_CMS_BASE_URL=http://localhost:8080
# Database DSN for CiviCRM (example). Keep secrets out of VCS.
# Format example: mysql://user:pass@host:3306/dbname
CIVICRM_DB_DSN=

# Path to Drupal root used by cv (defaults to DRUSH_ROOT or /var/www/html)
CV_ROOT=/opt/drupal/web
# Path to write the civicrm install log (optional)
CIVICRM_INSTALL_LOG=/var/log/civicrm-install.log

# Optional: HTTP port exposed by compose (used to generate default CMS URL)
PORT_HTTP=8080

# Notes:
# - To run automated installs in CI, set AUTO_INSTALL=1 and/or CIVICRM_INSTALL=1
#   and inject secure secrets (DB passwords, CIVICRM_DB_DSN) via your CI/secret manager.
# - If you need the container to error on DB or install failures set *_REQUIRED=1.